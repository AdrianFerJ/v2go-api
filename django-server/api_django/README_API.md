
# Django API Readme file

## Set up Development environment

**Required:** Python3.7 (doesn't need to be the default system python) and pip
```bash
# Install Python3.7, if it's not yet installed
$ sudo apt-get update
$ sudo apt-get install python3.7

# install pipenv
$ pip install pipenv

# Go into /django_server/, create a new virtual env and activate it
$ pipenv --python 3.7  # or path/to/python if no python 
$ pipenv shell

# Make sure pip is not v18.1, while venv is active.(Known issue with v18.1, fix src: https://github.com/pypa/pipenv/issues/2924)
$ (venv) pip --version

# *** IF pip==18.1, THEN downgrade to 18.0 (from within venv), if already 18.0 skip this 2 commands
$ (venv) pip install pipenv
$ (venv) pipenv run pip install pip==18.0

# If pip ==18.0 and Pipfile available,  then install packages
$ (venv) pipenv install

# Check that packages were installed
$ (venv) pipenv graph
```

## Run API locally
1. **Activate venv** and navigate to api_django/ 
2. **Apply data models (make migrations) and run server** 
    ```bash 
    (venv)$ ./manage.py makemigrations
    (venv)$ ./manage.py migrate
    (venv)$ ./manage.py runserver
    ``` 
3. **Open Web UI generated by Django REST Framework's Brosable API**

    Open [localhost](http://127.0.0.1:8000/api/sign_up/) in your browser to talk to the API via a Web UI autogenerated by [Brosable API](https://www.django-rest-framework.org/topics/browsable-api/). Read more bellow..

## API manual testing 

Django REST Framework's [Brosable API](https://www.django-rest-framework.org/topics/browsable-api/) generates human-friendly HTML output for each resource when the HTML format is requested. These pages allow for easy browsing of resources, as well as forms for submitting data to the resources using POST, PUT, and DELETE.

### User sign up
- End point: [http://127.0.0.1:8000/api/sign_up/](http://127.0.0.1:8000/api/sign_up/).
- Input: Use automatically generated web form
- Expected output: http response(status:200)

### User Login 
- End point: [http://127.0.0.1:8000/api/log_in/](http://127.0.0.1:8000/api/log_in/)
- Input: Username and password
    ```JSON
    {
        "username": "test1",
        "password": "letmein!"
    }
    ```
- Expected output: http response(status:200) + session ID stored in browser as cookie

### User Logout 
- End point: [http://127.0.0.1:8000/api/log_in/](http://127.0.0.1:8000/api/log_in/)
- Expected output: http response(status:403) + session ID removed from browser

### Get List of CSs
- End point: [http://127.0.0.1:8000/api/volt_finder/](http://127.0.0.1:8000/api/volt_finder/)
- Input: User location. *For now input is **None***
- Expected output: http response(status:200) + list of CSs (includes an estimated distance from user to CS location)

### Other API actionss
*For more API actions*, check [volt_finder/urls.py](volt_finder/urls.py)